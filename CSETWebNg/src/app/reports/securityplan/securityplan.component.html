<!----------------------

   Copyright 2024 Battelle Energy Alliance, LLC

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in all
  copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
-------------------------->
<div class="report-body mb-5" *transloco="let t">

    <div class="flex-container">
        <div class="column mt-3">
            <p class="report-title">
                {{t('reports.core.security plan.report title') | uppercase}}
            </p>
        </div>
        <div class="column">
            <p style="text-align: center">
                <img width="471" height="529" alt="cset" src="assets/images/SecurityPlanFiles/image002.jpg">
            </p>
        </div>

        <div class="cover-page-bottom mb-4">
            <app-logo-for-reports></app-logo-for-reports>
            <app-info-block [response]="response" />
        </div>
    </div>



    <div class="page-break" *ngIf="configSvc.behaviors.showDisclaimer">
        <app-report-disclaimer></app-report-disclaimer>
    </div>


    <div class="page-break">
        <h1>{{t('reports.core.security plan.signature')}}</h1>

        <p>{{t('reports.core.security plan.signature disclaimer')}}
        </p>

        <p>
            <b>
                <i>
                    {{t('reports.core.security plan.signature example')}}
                </i>
            </b>
        </p>

        <div style="margin-bottom: 100px">
            <div class="signature-block">
                <span class="signature">{{t('reports.core.security plan.signature example text 1')}}</span>
                <span class="date">{{t('reports.core.security plan.signature example text 2')}}</span>
            </div>
        </div>
    </div>



    <div class="page-break">
        <h1>
            {{t('reports.core.security plan.introduction')}}
        </h1>

        <p class="intro">
            {{t('reports.core.security plan.template instructions')}}
        </p>

        <p class="intro">{{t('reports.core.security plan.template instructions text 1')}}</p>

        <p class="intro">
            {{t('reports.core.security plan.template instructions text 2')}}
        </p>

        <p class="intro">
            {{t('reports.core.security plan.template instructions text 3')}}
        </p>

        <p class="intro">
            {{t('reports.core.security plan.template bullets')}}
        </p>

        <ul class="intro mb-3">
            <li>{{t('reports.core.security plan.template bullet text 1')}}</li>
            <li>
                {{t('reports.core.security plan.template bullet text 2')}}
            </li>
            <li>
                {{t('reports.core.security plan.template bullet text 3')}}
            </li>
            <li>
                {{t('reports.core.security plan.template bullet text 4')}}
            </li>
            <li>
                {{t('reports.core.security plan.template bullet text 5')}}
            </li>
            <li>
                {{t('reports.core.security plan.template bullet text 6')}}
            </li>
        </ul>
    </div>



    <div class="page-break">
        <h1>
            1. {{t('reports.core.security plan.system identification')}}
        </h1>

        <p class="intro">
            {{t('reports.core.security plan.system identification summary')}}
        </p>

        <h2>
            1.1. {{t('reports.core.security plan.system environment')}}
        </h2>

        <p class="intro">
            {{t('reports.core.security plan.system environment summary')}}
        </p>
        <ul class="intro mb-3">
            <li>{{t('reports.core.security plan.environment bullet text 1')}}</li>
            <li>{{t('reports.core.security plan.environment bullet text 2')}}</li>
            <li>{{t('reports.core.security plan.environment bullet text 3')}}</li>
            <li>{{t('reports.core.security plan.environment bullet text 4')}}</li>
            <li>{{t('reports.core.security plan.environment bullet text 5')}}</li>
            <li>{{t('reports.core.security plan.environment bullet text 6')}}</li>
        </ul>

        <p class="intro">
            {{t('reports.core.security plan.environment text 1')}}
        </p>

        <p class="intro">
            {{t('reports.core.security plan.environment text 2')}}
        </p>
    </div>



    <!--Network Diagram-->
    <div class="page-break" *ngIf="response?.information.useDiagram">
        <h1>{{t('reports.network diagram')}}</h1>
        <div style="display: table; height: 8in">
            <div style="padding: 50% 0; height: 0">
                <div style="width: 8in; display: block; transform-origin: top left; transform: rotate(90deg) translate(0, -100%); margin-top: -50%"
                    [innerHTML]="networkDiagramImage">
                </div>
            </div>
        </div>
    </div>


    <div class="page-break">
        <h1>
            2. {{t('reports.core.security plan.roles and responsibilities')}}
        </h1>

        <p class="intro">{{t('reports.core.security plan.roles and responsibilities summary')}}
        </p>

        <h2 id="goto">
            2.1. {{t('reports.core.security plan.executive management')}}
        </h2>

        <p>
            {{t('reports.core.security plan.executive management summary')}}
        </p>

        <h2>
            <span style='font-family:"Arial",sans-serif'>2.2.
                <span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>
            </span>
            <span style='font-family:"Arial",sans-serif'>{{t('reports.core.security plan.chief security
                officer')}}</span>
        </h2>

        <p>
            {{t('reports.core.security plan.chief security summary')}}
        </p>

        <p>
            {{t('reports.core.security plan.chief security bullet header')}}
        </p>

        <ul>
            <li>{{t('reports.core.security plan.chief security bullet text 1')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 2')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 3')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 4')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 5')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 6')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 7')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 8')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 9')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 10')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 11')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 12')}}</li>
            <li>{{t('reports.core.security plan.chief security bullet text 13')}}</li>
        </ul>


        <h2>
            2.3. {{t('reports.core.security plan.security steering committee')}}
        </h2>

        <p>
            {{t('reports.core.security plan.security steering text 1')}}
        </p>

        <p>
            {{t('reports.core.security plan.security steering text 2')}}
        </p>

        <ul>
            <li>{{t('reports.core.security plan.security steering bullet text 1')}}</li>
            <li>{{t('reports.core.security plan.security steering bullet text 2')}}</li>
            <li>{{t('reports.core.security plan.security steering bullet text 3')}}</li>
            <li>{{t('reports.core.security plan.security steering bullet text 4')}}</li>
            <li>{{t('reports.core.security plan.security steering bullet text 5')}}</li>
            <li>{{t('reports.core.security plan.security steering bullet text 6')}}</li>
            <li>{{t('reports.core.security plan.security steering bullet text 7')}}</li>
        </ul>




        <p>
            {{t('reports.core.security plan.security steering text 3')}}
        </p>

        <h2>
            2.4. {{t('reports.core.security plan.system owners')}}
        </h2>

        <p>
            {{t('reports.core.security plan.system owner text')}}
        </p>

        <h2>
            2.5. {{t('reports.core.security plan.data owners')}}
        </h2>

        <p>
            {{t('reports.core.security plan.data owner text')}}
        </p>

        <h2>
            2.6. {{t('reports.core.security plan.security admins')}}
        </h2>

        <p>
            {{t('reports.core.security plan.security admin text')}}
        </p>

        <h2>
            2.7. {{t('reports.core.security plan.supervisors managers')}}
        </h2>

        <p>
            {{t('reports.core.security plan.supervisors managers text')}}
        </p>

        <h2>
            2.8. {{t('reports.core.security plan.users')}}
        </h2>

        <p>
            {{t('reports.core.security plan.user text')}}
        </p>
    </div>


    <div class="page-break">
        <h1>
            3. {{t('reports.core.security plan.risk analysis')}}
        </h1>

        <p class="intro">{{t('reports.core.security plan.risk analysis text')}}
        </p>

        <p class="intro">{{t('reports.core.security plan.threats')}}
        </p>

        <p class="intro">{{t('reports.core.security plan.total risk')}}
        </p>


        <h4>{{t('reports.core.security plan.consequence')}}</h4>
        <p class="intro">{{t('reports.core.security plan.consequence examination')}}
        </p>
        <ul class="intro mb-3">
            <li>{{t('reports.core.security plan.consequence bullet text 1')}}</li>
            <li>{{t('reports.core.security plan.consequence bullet text 2')}}</li>
            <li>{{t('reports.core.security plan.consequence bullet text 3')}}</li>
            <li>{{t('reports.core.security plan.consequence bullet text 4')}}</li>
            <li>{{t('reports.core.security plan.consequence bullet text 5')}}</li>
        </ul>

        <h4>{{t('reports.core.security plan.threat')}}</h4>
        <p class="intro">{{t('reports.core.security plan.threat text')}}
        </p>

        <h4>{{t('reports.core.security plan.cost benefit analysis')}}</h4>
        <p class="intro">{{t('reports.core.security plan.cost benefit text')}}
        </p>


        <h2>
            3.1 {{t('reports.core.security plan.basic model')}}
        </h2>

        <p>
            {{t('reports.core.security plan.basic model text')}}
        </p>

        <h3>
            3.1.1 {{t('reports.core.security plan.confidentiality')}}
        </h3>

        <p>{{t('reports.core.security plan.confidentiality text 1')}}</p>

        <p>{{t('reports.core.security plan.confidentiality text 2')}}
        </p>

        <h3>
            3.1.2 {{t('reports.core.security plan.integrity')}}
        </h3>

        <p>{{t('reports.core.security plan.integrity text')}}
        </p>

        <h3>
            3.1.3 {{t('reports.core.security plan.availability')}}
        </h3>

        <p>{{t('reports.core.security plan.availability text')}}
        </p>

        <ng-container *ngIf="!usesRAC()">
            <h2>
                3.2 {{t('titles.sal.security assurance level (sal)')}}
            </h2>

            <app-sal-section *ngIf="response" [response]="response"></app-sal-section>


            <div class="mt-3 mb-4" *ngIf="reportSvc.isInstallation('ACET')">
                <h2>Inherent Risk Profile</h2>
                <app-inherent-risk-profile [acetDashboard]="acetDashboard"></app-inherent-risk-profile>

                <div class="ms-3">
                    <div>Overall Risk Level is <span class="blue-text font-weight-bold">
                            {{ acetSvc.interpretRiskLevel(acetDashboard?.sumRiskLevel) }}
                        </span>
                    </div>
                    <div
                        *ngIf="!acetDashboard?.override || acetDashboard?.override == '' || acetDashboard?.override == 0">
                        Overall Risk Level has not been overridden
                    </div>
                    <div
                        *ngIf="!!acetDashboard?.override && acetDashboard?.override != '' && acetDashboard?.override !== 0">
                        Overall Risk Level has been overriden to <span class="blue-text font-weight-bold">{{
                            acetSvc.interpretRiskLevel(acetDashboard?.override) }}</span>
                        <div>Override Reason:
                            <em>
                                {{ acetDashboard?.overrideReason }}
                            </em>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="reportSvc.isInstallation('ACET')">
                <h2>Cybersecurity Maturity</h2>
                <table class="cset-table">
                    <tr>
                        <th width="50%" class="table-head">Domain</th>
                        <th width="50%" class="table-head">Maturity Level</th>
                    </tr>
                    <tr *ngFor="let domain of acetDashboard?.domains; let i = index">
                        <td>Domain {{ i + 1 }}: {{ domain.name }}</td>
                        <td class="mid-align">
                            <div class="alert mb-0" [ngClass]="acetSvc.maturityClasses(domain.maturity)">
                                {{ domain.maturity }}</div>
                        </td>
                    </tr>
                </table>
            </div>
        </ng-container>
    </div>

    <div class="page-break" *ngIf="response?.zones.length > 0">
        <h1>
            {{t('reports.core.security plan.diagram component inventory')}}
        </h1>
        <div *ngFor="let zoneList of response?.zones">
            <table class="cset-table">
                <tr>
                    <th>{{t('reports.core.security plan.zone', {zoneName: zoneList[0].zone_Name})}}</th>
                    <th>{{t('reports.core.security plan.sal level', {level: zoneList[0].universal_Sal_Level})}}</th>
                </tr>
                <tr *ngFor="let inventoryItem of zoneList">
                    <td>{{inventoryItem.diagram_Component_Type}}</td>
                    <td [innerHTML]="inventoryItem.label"></td>
                </tr>
            </table>
        </div>
    </div>



    <div class="page-break">
        <h1>
            4. {{t('reports.core.security plan.plan controls')}}
        </h1>

        <p>
            {{t('reports.core.security plan.plan controls text')}}
        </p>

        <p>
            <b>
                {{t('reports.core.security plan.table key header')}}
            </b>
        </p>

        <table class="cset-table-2">
            <tr>
                <td colspan="2">
                    {{t('reports.core.security plan.requirement title')}}
                </td>
                <td>{{t('reports.core.security plan.cset question requirement category')}}
                </td>
            </tr>
            <tr class="pale-green">
                <td>
                    {{t('reports.core.security plan.control level')}}
                </td>
                <td>{{t('reports.core.security plan.implementation status')}}
                </td>
                <td>{{t('reports.core.security plan.short standard name')}}
                </td>
            </tr>
            <tr>
                <td colspan="3">{{t('reports.core.security plan.requirement description')}}
                </td>
            </tr>
            <tr>
                <td colspan="3">{{t('reports.core.security plan.affected zones')}}
                </td>
            </tr>
            <tr>
                <td colspan="3">{{t('reports.core.security plan.affected components')}}
                </td>
            </tr>
            <tr>
                <td colspan="3">{{t('reports.core.security plan.affected zones')}}
                </td>
            </tr>
        </table>

        <p>
            <b>{{t('reports.core.security plan.requirement title')}}:</b> {{t('reports.core.security plan.requirement
            title text')}}
        </p>

        <p>
            <b>
                {{t('reports.core.security plan.cset question category')}}:
            </b>
            {{t('reports.core.security plan.cset question category text')}}
        </p>

        <p>
            <b>
                {{t('reports.core.security plan.control level')}}:
            </b>
            {{t('reports.core.security plan.control level text')}}
        </p>

        <p>
            <b>
                {{t('reports.core.security plan.implementation status')}}:
            </b>
            {{t('reports.core.security plan.implementation status text')}}
        </p>

        <p>
            <b>
                {{t('reports.core.security plan.short standard name')}}:
            </b>
            {{t('reports.core.security plan.short standard name text')}}
        </p>

        <p>
            <b>
                {{t('reports.core.security plan.control description')}}:
            </b>
            {{t('reports.core.security plan.control description text')}}

        </p>

        <p>
            <b>
                {{t('reports.core.security plan.affected zones')}}:
            </b>
            {{t('reports.core.security plan.affected zones text')}}

        </p>

        <p>
            <b>
                {{t('reports.core.security plan.affected components')}}:
            </b>
            {{t('reports.core.security plan.affected components text')}}
        </p>

        <p>
            <b>
                {{t('reports.core.security plan.related questions')}}:
            </b>
            {{t('reports.core.security plan.related questions text')}}
        </p>

        <div style="margin-bottom: 3em"></div>


        <div *ngFor="let control of response?.controlList" style="margin-bottom: 2em;">
            <table *ngIf="!response.information.useDiagram" class="cset-table-2">
                <tr>
                    <td colspan="2" style="font-weight: bold;">
                        {{control.requirementTitle}}
                    </td>
                    <td>
                        {{control.standard_Category}}
                        <span *ngIf="control.subCategory?.length > 0">
                            / {{control.subCategory}}
                        </span>
                    </td>
                </tr>
                <tr class="pale-green">
                    <td style="width: 20%">
                        {{t('titles.sal.level.'+ analysisSvc.salWord(control.level).toLowerCase())}}
                    </td>
                    <td style="width: 20%">
                        {{control.implementationStatus}}
                        <span *ngIf="control.implementationStatus != null
                    && control.implementationStatus.length > 0">%</span>
                    </td>
                    <td style="width: 60%">
                        {{control.standardShortName}} <!-- XXX -->
                    </td>
                </tr>
                <tr>
                    <td colspan="3" [innerHTML]="control.controlDescription">
                    </td>
                </tr>
                <tr *ngIf="control.affectedZones">
                    <td colspan="3">{{control.affectedZones}}
                    </td>
                </tr>
                <tr *ngIf="control.affectedComponents">
                    <td colspan="3">{{control.affectedComponents}}
                    </td>
                </tr>
                <!-- display all questions for the control/requirement -->
                <tr *ngIf="response.applicationMode == 'Questions Based'">
                    <td colspan="3">
                        <table class="related-questions">
                            <tr *ngFor="let q of control.control_Questions">
                                <td>{{q.simple_Question}}</td>
                                <td style="width: 10%; text-align: center;">{{t('answer-options.labels.' +
                                    q.answer.toLowerCase())}}</td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <table *ngIf="response.information.useDiagram" class="cset-table-2">
                <tr>
                    <td colspan="2" style="font-weight: bold;">
                        {{control.requirementTitle}}
                    </td>
                    <td>
                        <span *ngIf="control.subCategory?.length > 0">
                            {{control.subCategory}}
                        </span>
                    </td>
                </tr>
                <tr class="pale-green">
                    <td style="width: 20%">
                        {{analysisSvc.salWord(control.level)}}
                    </td>
                    <td style="width: 20%">
                        {{control.implementationStatus}}
                        <span *ngIf="control.implementationStatus != null
                    && control.implementationStatus.length > 0">%</span>
                    </td>
                    <td style="width: 60%">
                    </td>
                </tr>
                <tr>
                    <td colspan="3" [innerHTML]="control.controlDescription">
                    </td>
                </tr>
                <tr *ngIf="control.affectedZones">
                    <td colspan="3">{{control.affectedZones}}
                    </td>
                </tr>
                <tr *ngIf="control.affectedComponents">
                    <td colspan="3">{{control.affectedComponents}}
                    </td>
                </tr>
                <!-- display all questions for the control/requirement -->
                <tr *ngIf="response.applicationMode == 'Questions Based'">
                    <td colspan="3">
                        <table class="related-questions">
                            <tr *ngFor="let q of control.control_Questions">
                                <td>{{q.simple_Question}}</td>
                                <td style="width: 10%; text-align: center;">{{q.answer}}</td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>